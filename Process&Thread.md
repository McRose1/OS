# 进程 vs. 线程

## 多进程和多线程的区别
|维度|多进程|多线程|总结|
|---|---|---|---|
|数据共享、同步|数据是分开的：共享复杂，需要用IPC；同步简单|多线程共享进程数据：共享简单；同步复杂|各有优势|
|内存、CPU|占用内存多，切换复杂，CPU利用率低| 占用内存少，切换简单，CPU利用率高|线程占有|
|创建销毁切换|创建销毁切换复杂，速度慢|创建销毁切换简单，速度快|线程占优|
|编程调试|编程简单，调试简单|编程复杂，调试复杂|进程占优|
|可靠性|进程间不会相互影响|一个线程挂掉将导致整个进程挂掉|进程占优|
|分布式|适用于多核、多机分布；如果一台机器不够，扩展到多台机器比较简单|适应于多核分布|进程占优|

---

子进程继承父进程的属性：
- 实际用户ID、实际组ID、有效用户ID、有效组ID
- 附加组ID
- 进程组ID
- 会话ID
- 控制终端
- 设置用户ID标志和设置组ID标志
- 当前工作目录
- 根目录
- 文件模式创建屏蔽字（unmask）
- 信号屏蔽和安排
- 针对任一打开文件描述符的在执行时关闭（close-on-exec）状态
- 环境
- 连接的共享存储段
- 存储映射
- 资源限制

子线程继承主线程的属性：
- 进程中的所有信息对该进程的所有线程都是共享的
- 可执行的程序文本
- 程序的全局内存
- 堆内存
- 栈
- 文件描述符
- 信号的处理是进程中的所有线程共享的（注意：如果信号的默认处理是终止该进程那么即是把信号传给某个线程也一样会将进程杀掉）

---
父子进程之间的区别
- fork 的返回值（=0子进程）
- 进程ID不同
- 两个进程具有不同的父进程ID
- 子进程的 tms_utime, tms_stime, tms_cutime 以及 tms_ustime 均被设置为0
- 不继承父进程设置的文件锁
- 子进程的未处理闹钟被清除
- 子进程的未处理信号集设置为空集

子线程特有的：
- 线程ID
- 一组寄存器值
- 栈
- 调度优先级和策略
- 信号屏蔽字
- errno变量
- 线程私有数据


